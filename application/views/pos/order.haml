.container-fluid
  .row
    #table-area{:class => 'col-sm-9 col-md-9'}
      .panel{:class => 'panel-default'}
        .panel-heading
          %strong #{$zone[0]->e_full_name}
          %input{:type => 'hidden', :id => 'zone_id', :value => '#{!empty($zone_id) ? $zone_id : ""}'}
          %input{:type => 'hidden', :id => 'order_id', :value => '#{!empty($zone_id) ? $order_id : ""}'}
        .panel-body{:id => 'js-table-area'}
          - for ($i=1; $i < $zone[0]->value1; $i++):
            .col-md-2
              - if(empty($table_order[$i])):
                %button{:class => 'btn btn-info table-area js-table-btn', :data-table => '#{$i}', :data-zone => '#{$zone[0]->e_abb_name}'} =$i
              - elseif($table_order[$i] == 'existed'):
                %button{:class => 'btn btn-default table-area js-table-btn', :data-table => '#{$i}', :data-zone => '#{$zone[0]->e_abb_name}'} =$i
              - elseif($table_order[$i] == 'booked'):
                %button{:class => 'btn btn-warning disabled table-area', :data-table => '#{$i}', :data-zone => '#{$zone[0]->e_abb_name}'} =$i
              - endif
          - endfor
    #pos-list{:class => 'col-md-3'}
      .row
        .panel{:class => 'panel-default'}
          .panel-heading
            .row
              %span{:class => 'label-table col-md-2'} โต๊ะ
              #js-table-list{:class => 'col-md-10'}
                - for ($i=1; $i < $zone[0]->value1; $i++):
                  - if(empty($table_order[$i])):
                    %span{:class => 'label label-default js-table-number hide' , :data-table => '#{$i}'} =$i
                  - elseif($table_order[$i] == 'existed'):
                    %span{:class => 'label label-default js-table-number' , :data-table => '#{$i}'} =$i
                  - endif
                - endfor
            .row
              .product-selection{:class => 'col-md-12'}
                %button{:class => 'btn btn-primary js-product-selection col-md-12', :data-toggle => 'modal', :data-target => '#myModal'} เลือกสินค้า

          %table{:class => 'table'}
            %tr
              %th{:class => 'col-md-1'}
                #
              %th{:class => 'col-md-6'}
                รายการสั่งซื้อ
              %th{:class => 'col-md-3'}
                จำนวน
              %th{:class => 'col-md-2'}
                รวม
          .panel-body{:id => 'order-list'}
            .row
              %table{:class => 'table table-striped'}
                - for ($i=1; $i < 60;):
                  %tr
                    %td #{$i}
                    %td{:class => 'col-md-6'} Soup
                    %td{:class => 'col-md-3'}
                      %input{:type =>'number', :class => 'col-md-12'}
                    %td{:class => 'col-md-2'} 1000
                  - $i++
                - endfor

          .panel-footer
            %span{:class => 'col-md-4'} Total
            .input-group{:class => 'col-md-8'}
              %span{:class => 'input-group-addon'} ฿
              %input{:type => text, :class => 'form-control'}
              %span{:class => 'input-group-addon'} .00

        #pos-btn-panel
          %button{:class => 'btn btn-success col-md-5'} 
            %i{:class => 'fa fa-money'} 
            %span รับเงิน
          %button{:class => 'btn btn-info col-md-5 col-md-offset-2'} 
            %i{:class => 'fa fa-print'}
            %span Print
          %a{:href => '/pos'}
            %button{:class => 'btn btn-default col-md-5'} 
              %i{:class => 'fa fa-reply'}
              %span Back
          %button{:class => 'btn btn-danger col-md-5 col-md-offset-2'}
            %i{:class => 'fa fa-trash'}
            %span ลบ
= $product_modal
:javascript
  var fullScreenPanel = $(window).height() - 100;
  var fullScreenOrderList = $(window).height() - 360;

  $('#js-table-area').height(fullScreenPanel).css('overflow' , 'auto');
  $('#order-list').height(fullScreenOrderList).css('overflow' , 'auto');

  $('.js-table-btn').click(function(){
    var tableNumber = $(this).data('table');
    var tableZone = $(this).data('zone');
    var order = $('#order_id').val();
    var base = this;

    if($(this).hasClass('btn-info')){  
      $.ajax({
        method: "POST",
        url: "/pos/add_table",
        data: { table: tableNumber,
                zone:  tableZone,
                order: order},
        datatype: "json",
        success: function(data){
            obj = JSON.parse(data);

            if(obj.order_id != order){
              $('#order_id').val(obj.order);
            }

            $(base).removeClass('btn-info');
            $(base).addClass('btn-default');
            addTableLabel(tableNumber);
        }
      });
    }else if($(this).hasClass('btn-default')){
      $.ajax({
        method: "POST",
        url: "/pos/remove_table",
        data: { table: tableNumber,
                zone:  tableZone,
                order: order},
        datatype: "json",
        success: function(){
            $(base).addClass('btn-info');
            $(base).removeClass('btn-default');
            removeTableLabel(tableNumber);
        }
      });

    }
    
  });

  function addTableLabel(number) {
    $('.js-table-number').each(function(){
      if($(this).data('table') == number){
        $(this).removeClass('hide');
      }
    });    
  }

  function removeTableLabel(number) {
    $('.js-table-number').each(function(){
      if($(this).data('table') == number){
        $(this).addClass('hide');
      }
    });    
  }

